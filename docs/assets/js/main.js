"use strict";const input=document.querySelector(".js_input"),buttonSearch=document.querySelector(".js_button"),seriesList=document.querySelector(".js_list");let series=[],favouriteList=document.querySelector(".js_favourites");const reset=document.querySelector(".js_reset");let favourites=[],favSelected=[];function urlCreator(){return"//api.tvmaze.com/search/shows?q="+input.value}function paintSeries(){let e="",t="";seriesList.innerHTML="";for(const s of series){const i=s.show.id,a=s.show.name,n=s.show.image;if(t=searchFavourites(s)?"__clicked":"",e+=`<li class="list__elements js_elements" id= "${i}">`,null===n){e+=`<img class="list__elements--image${t} js_image" src="${"https://via.placeholder.com/210x295/ffffff/666666/text=TV"}" alt="Cartel de la serie"></img>`}else e+=`<img class="list__elements--image${t} js_image" src="${n.original}" alt="Cartel de la serie"></img>`;e+=`<p class="list__elements--series${t} js_series">${a}</p>`,e+="</li>"}seriesList.innerHTML=e,listenerSelection()}function handleSearchSeries(e){e.preventDefault();let t=urlCreator();fetch(t).then(e=>e.json()).then(e=>{series=e,paintSeries()})}function handleFavSelect(e){const t=parseInt(e.currentTarget.id),s=series.find(e=>e.show.id===t),i=favourites.findIndex(e=>e.show.id===t);if(favSelected=s,-1===i){favourites.push(s);paintFavList(favSelected),savedFavList()}else{favourites.splice(i,1),savedFavList(),favouriteList.innerHTML="";for(const e of favourites)paintFavList(e)}paintSeries(),listenerRemove(),addReset()}function paintFavList(e){let t="";favouriteList.innerHTML="";for(const e of favourites){const s=e.show.id,i=e.show.name,a=e.show.image;if(t+='<li class="favourites__series " >',t+='<div class="favourites__elements">',null===a){t+=`<img class="favourites__elements--image " src="${"https://via.placeholder.com/210x295/ffffff/666666/text=TV"}" alt="Cartel de la serie"></img>`}else t+=`<img class="favourites__elements--image " src="${a.original}" alt="Cartel de la serie"></img>`;t+=`<p class="favourites__elements--series ">${i}</p>`,t+="</div>",t+=`<button name="${s}" class ="favourites__button js_removeButton"><i class="far fa-trash-alt"></i>\n        </button>`,t+="</li>"}favouriteList.innerHTML=t,listenerRemove()}function searchFavourites(e){return void 0!==favourites.find(t=>t.show.id===e.show.id)}function listenerSelection(){const e=document.querySelectorAll(".js_elements");for(const t of e)t.addEventListener("click",handleFavSelect)}function handleFavRemove(e){if(null!==favourites){const t=parseInt(e.currentTarget.name),s=favourites.findIndex(e=>e.show.id===t);favourites.splice(s,1);paintFavList(),paintSeries()}}function listenerRemove(){const e=document.querySelectorAll(".js_removeButton");for(const t of e)t.addEventListener("click",handleFavRemove);savedFavList()}function addReset(){favourites.length>1?reset.classList.remove("hidden"):reset.classList.add("hidden")}function handleResetFavList(){favourites=[],paintFavList(favSelected),savedFavList()}function savedFavList(){localStorage.setItem("favourites",JSON.stringify(favourites))}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("favourites"));favourites=null===e?[]:e;for(const e of favourites)paintFavList(e),addReset()}addReset(),getLocalStorage(),console.log(favourites),buttonSearch.addEventListener("click",handleSearchSeries),reset.addEventListener("click",handleResetFavList);